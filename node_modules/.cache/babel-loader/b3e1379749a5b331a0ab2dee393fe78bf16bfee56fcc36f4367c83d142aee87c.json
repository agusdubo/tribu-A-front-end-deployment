{"ast":null,"code":"import _objectSpread from\"/home/agusdubo/Desktop/IS1/tribu-A-frontend-2025-2C/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{Plus,Edit2,Loader,ArrowLeft,Calendar,Filter,Layers,Trash2}from'lucide-react';import{ApiService}from'../services/api';import AuthService from'../services/AuthService';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CostosPage=()=>{var _user$name;const navigate=useNavigate();const user=AuthService.getCurrentUser();const[costos,setCostos]=useState([]);const[loading,setLoading]=useState(true);// Catálogo completo de roles (ID, Nombre, Experiencia)\nconst[allRolesData,setAllRolesData]=useState([]);// Modales\nconst[isModalOpen,setIsModalOpen]=useState(false);const[isMassModalOpen,setIsMassModalOpen]=useState(false);// Filtros\nconst[filtroMes,setFiltroMes]=useState(new Date().getMonth()+1);const[filtroAnio,setFiltroAnio]=useState(new Date().getFullYear());// Form individual\nconst[formData,setFormData]=useState({rol:'',seniority:'',costo:'',moneda:'USD',mes:new Date().getMonth()+1,anio:new Date().getFullYear()});// Form masivo\nconst[massFormData,setMassFormData]=useState({mes:new Date().getMonth()+1,anio:new Date().getFullYear(),porcentaje:''});// Edición individual\nconst[usarPorcentaje,setUsarPorcentaje]=useState(false);const[porcentaje,setPorcentaje]=useState('');const[costoBase,setCostoBase]=useState(0);const[editingId,setEditingId]=useState(null);const MESES=[{id:1,nombre:'Enero'},{id:2,nombre:'Febrero'},{id:3,nombre:'Marzo'},{id:4,nombre:'Abril'},{id:5,nombre:'Mayo'},{id:6,nombre:'Junio'},{id:7,nombre:'Julio'},{id:8,nombre:'Agosto'},{id:9,nombre:'Septiembre'},{id:10,nombre:'Octubre'},{id:11,nombre:'Noviembre'},{id:12,nombre:'Diciembre'}];// --- Lógica de carga de datos ---\nconst loadData=async()=>{setLoading(true);try{// 1. Traemos Costos y Roles (objetos completos) en paralelo\nconst[dataCostos,dataRolesCompletos]=await Promise.all([ApiService.obtenerCostosVigentes(),ApiService.obtenerTodosLosRoles()]);// Guardamos el catálogo completo para usarlo en el formulario\nsetAllRolesData(dataRolesCompletos||[]);// 2. Cruzamos la información para la tabla\nconst datosProcesados=dataCostos.map(item=>{const rolEncontrado=dataRolesCompletos.find(r=>r.id===item.rolId);const rolDisplay=rolEncontrado?rolEncontrado.nombre:'Rol Desconocido';const seniorityDisplay=rolEncontrado?rolEncontrado.experiencia:'N/A';return _objectSpread(_objectSpread({},item),{},{rolDisplay,seniorityDisplay});});setCostos(datosProcesados);}catch(error){console.error(\"Error cargando costos\",error);}finally{setLoading(false);}};useEffect(()=>{loadData();},[]);const costosFiltrados=costos.filter(c=>{if(!c.fecha)return false;const partes=c.fecha.split('-');// \"YYYY-MM-DD\"\nconst anioCosto=parseInt(partes[0]);const mesCosto=parseInt(partes[1]);return anioCosto===parseInt(filtroAnio)&&mesCosto===parseInt(filtroMes);});const calcularValorConPorcentaje=(valorBase,porc)=>{if(!valorBase||isNaN(valorBase)||!porc||isNaN(porc))return valorBase;const base=parseFloat(valorBase);const p=parseFloat(porc);const resultado=base+base*(p/100);// Retornamos string fijo, pero validamos negativo después\nreturn resultado.toFixed(2);};useEffect(()=>{if(usarPorcentaje&&editingId){const nuevoValor=calcularValorConPorcentaje(costoBase,porcentaje);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{costo:nuevoValor}));}},[porcentaje,usarPorcentaje,costoBase,editingId]);// Obtener lista de Nombres de Roles Únicos para el select\nconst uniqueRoles=[...new Set(allRolesData.map(r=>r.nombre))].sort();// Obtener lista de Experiencias filtradas por el Rol seleccionado\nconst filteredExperiencias=allRolesData.filter(r=>r.nombre===formData.rol).map(r=>r.experiencia).sort();const handleEdit=item=>{setEditingId(item.id);let mesEdit=new Date().getMonth()+1;let anioEdit=new Date().getFullYear();if(item.fecha){const partes=item.fecha.split('-');if(partes.length>=2){anioEdit=parseInt(partes[0]);mesEdit=parseInt(partes[1]);}}setCostoBase(item.costo);setUsarPorcentaje(false);setPorcentaje('');setFormData({rol:item.rolDisplay,seniority:item.seniorityDisplay!=='N/A'?item.seniorityDisplay:'',costo:item.costo,moneda:'USD',mes:mesEdit,anio:anioEdit});setIsModalOpen(true);};const handleDelete=async id=>{if(window.confirm(\"¿Estás seguro de que deseas eliminar este costo? Esta acción no se puede deshacer.\")){try{await ApiService.eliminarCosto(id);alert(\"Costo eliminado correctamente\");loadData();}catch(error){console.error(error);alert(\"Error al eliminar el costo\");}}};const handleSave=async e=>{e.preventDefault();// --- VALIDACIÓN DE COSTO NEGATIVO ---\nif(parseFloat(formData.costo)<0){alert(\"El costo no puede ser negativo. Por favor ingrese un valor válido.\");return;}// ------------------------------------\n// --- VALIDACIÓN DE DUPLICADOS ---\nconst existeDuplicado=costos.some(c=>{// Si estamos editando, no comparamos contra el mismo registro\nif(editingId&&c.id===editingId)return false;// Obtenemos mes y año del costo existente\nif(!c.fecha)return false;const[anioStr,mesStr]=c.fecha.split('-');const anioCosto=parseInt(anioStr);const mesCosto=parseInt(mesStr);// Comparamos: Rol (nombre), Seniority, Mes y Año\nreturn c.rolDisplay===formData.rol&&c.seniorityDisplay===formData.seniority&&anioCosto===parseInt(formData.anio)&&mesCosto===parseInt(formData.mes);});if(existeDuplicado){alert(\"Ya existe un costo registrado para el rol \\\"\".concat(formData.rol,\"\\\" (\").concat(formData.seniority,\") en este per\\xEDodo.\"));return;// Detenemos la ejecución aquí\n}// ---------------------------------\nconst datosCosto={rolId:formData.rol,nombre:formData.rol,experiencia:formData.seniority,costo:formData.costo.toString(),mes:parseInt(formData.mes),anio:parseInt(formData.anio)};try{if(editingId){await ApiService.actualizarCosto(editingId,datosCosto);alert(\"Costo mensual actualizado correctamente\");}else{await ApiService.crearCosto(datosCosto);alert(\"Nuevo costo mensual registrado\");}setIsModalOpen(false);setEditingId(null);setUsarPorcentaje(false);setPorcentaje('');setFiltroMes(parseInt(formData.mes));setFiltroAnio(parseInt(formData.anio));loadData();}catch(e2){console.error(e2);alert(\"Error al guardar la operación. Verifique los datos\");}};const handleNuevoCosto=()=>{setFormData({rol:'',seniority:'',costo:'',mes:filtroMes,anio:filtroAnio});setEditingId(null);setUsarPorcentaje(false);setIsModalOpen(true);};const handleMassUpdate=async e=>{e.preventDefault();const costosAfectados=costos.filter(c=>{if(!c.fecha)return false;const partes=c.fecha.split('-');const anioCosto=parseInt(partes[0]);const mesCosto=parseInt(partes[1]);return anioCosto===parseInt(massFormData.anio)&&mesCosto===parseInt(massFormData.mes);});if(costosAfectados.length===0){alert(\"No hay costos registrados para el mes seleccionado\");return;}// --- VALIDACIÓN PREVIA: ¿Algún costo queda negativo? ---\nconst algunNegativo=costosAfectados.some(c=>{const nuevoValor=calcularValorConPorcentaje(c.costo,massFormData.porcentaje);return parseFloat(nuevoValor)<0;});if(algunNegativo){alert(\"La operación no se puede realizar porque resultaría en costos negativos para uno o más roles.\");return;}// -------------------------------------------------------\nif(!window.confirm(\"Se actualizar\\xE1n \".concat(costosAfectados.length,\" costos con un \").concat(massFormData.porcentaje,\"%. \\xBFContinuar?\"))){return;}setLoading(true);try{const promesas=costosAfectados.map(costo=>{const nuevoValor=calcularValorConPorcentaje(costo.costo,massFormData.porcentaje);const datosCosto={costo:nuevoValor.toString(),mes:parseInt(massFormData.mes),anio:parseInt(massFormData.anio)};return ApiService.actualizarCosto(costo.id,datosCosto);});await Promise.all(promesas);alert(\"Actualización masiva completada con éxito\");setIsMassModalOpen(false);setFiltroMes(parseInt(massFormData.mes));setFiltroAnio(parseInt(massFormData.anio));loadData();}catch(error){console.error(\"Error en actualización masiva:\",error);alert(\"Ocurrió un error durante la actualización masiva. Algunos costos pueden no haberse actualizado\");loadData();}finally{setLoading(false);}};const formatVigencia=fechaString=>{if(!fechaString)return'-';const partes=fechaString.split('-');if(partes.length<2)return fechaString;const anio=partes[0];const mesIndex=parseInt(partes[1])-1;const nombreMes=MESES[mesIndex]?MESES[mesIndex].nombre:partes[1];return\"\".concat(nombreMes,\" \").concat(anio);};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-50 font-sans text-gray-900\",children:[/*#__PURE__*/_jsx(\"header\",{className:\"bg-white border-b border-gray-200 shadow-sm sticky top-0 z-10\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center h-16\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/finanzas/dashboard'),className:\"p-2 rounded-full text-gray-500 hover:bg-gray-100 hover:text-gray-800 transition-colors\",title:\"Volver al Men\\xFA\",children:/*#__PURE__*/_jsx(ArrowLeft,{className:\"h-6 w-6\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center space-x-2 border-l border-gray-200 pl-4 h-8\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-xl font-bold tracking-tight text-gray-900\",children:\"Gesti\\xF3n de Costos\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"hidden sm:block font-medium text-gray-500\",children:(user===null||user===void 0?void 0:user.name)||'Manager'}),/*#__PURE__*/_jsx(\"div\",{className:\"h-10 w-10 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold\",children:(user===null||user===void 0?void 0:(_user$name=user.name)===null||_user$name===void 0?void 0:_user$name.charAt(0))||'M'})]})]})})}),/*#__PURE__*/_jsxs(\"main\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-4 rounded-xl shadow-sm border border-gray-200 mb-6 flex flex-col md:flex-row justify-between items-center gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4 w-full md:w-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 text-gray-700 font-medium\",children:[/*#__PURE__*/_jsx(Filter,{className:\"h-5 w-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Periodo:\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"select\",{className:\"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5\",value:filtroMes,onChange:e=>setFiltroMes(parseInt(e.target.value)),children:MESES.map(m=>/*#__PURE__*/_jsx(\"option\",{value:m.id,children:m.nombre},m.id))}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5 w-24 appearance-none\",value:filtroAnio,onChange:e=>setFiltroAnio(parseInt(e.target.value)),min:\"2020\",max:\"2030\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 w-full md:w-auto\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setMassFormData({mes:filtroMes,anio:filtroAnio,porcentaje:''});setIsMassModalOpen(true);},className:\"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 shadow-sm transition justify-center text-sm\",children:[/*#__PURE__*/_jsx(Layers,{size:18}),\" Ajuste Masivo\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleNuevoCosto,className:\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 shadow-sm transition justify-center text-sm\",children:[/*#__PURE__*/_jsx(Plus,{size:18}),\" Nuevo Costo\"]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full text-left\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50 text-gray-600 text-sm uppercase\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 font-semibold\",children:\"Nombre del Rol\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 font-semibold\",children:\"Experiencia\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 font-semibold\",children:\"Costo por Hora\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 font-semibold min-w-[150px]\",children:\"Mes de Vigencia\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 font-semibold text-right min-w-[120px]\",children:\"Acciones\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"divide-y divide-gray-100\",children:loading?/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"5\",className:\"p-8 text-center\",children:/*#__PURE__*/_jsx(Loader,{className:\"animate-spin mx-auto text-blue-500\"})})}):costosFiltrados.length>0?costosFiltrados.map((c,index)=>/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-gray-50 transition\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 font-medium text-gray-800\",children:c.rolDisplay}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4\",children:/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 rounded-full text-xs font-medium border \".concat(c.seniorityDisplay==='Senior'?'bg-purple-50 text-purple-700 border-purple-100':c.seniorityDisplay==='Semi-Senior'?'bg-blue-50 text-blue-700 border-blue-100':'bg-gray-50 text-gray-700 border-gray-200'),children:c.seniorityDisplay})}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-6 py-4 font-mono text-gray-700 font-bold\",children:[\"USD \",c.costo]}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 text-sm text-gray-500 whitespace-nowrap\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Calendar,{size:14}),formatVigencia(c.fecha)]})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 text-right whitespace-nowrap\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleEdit(c),className:\"text-blue-600 hover:text-blue-800 font-medium text-sm flex items-center gap-1\",title:\"Editar\",children:/*#__PURE__*/_jsx(Edit2,{size:18})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDelete(c.id),className:\"text-red-600 hover:text-red-800 font-medium text-sm flex items-center gap-1 ml-2\",title:\"Eliminar\",children:/*#__PURE__*/_jsx(Trash2,{size:18})})]})})]},index)):/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsxs(\"td\",{colSpan:\"5\",className:\"px-6 py-12 text-center text-gray-500\",children:[\"No hay costos cargados para \",/*#__PURE__*/_jsxs(\"b\",{children:[MESES[filtroMes-1].nombre,\" \",filtroAnio]}),\".\"]})})})]})})]}),isModalOpen&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-2xl w-full max-w-md p-6 animate-fade-in\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold mb-4 text-gray-800\",children:editingId?'Editar Costo Mensual':'Registrar Costo Mensual'}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSave,className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4 p-4 bg-blue-50 rounded-lg border border-blue-100\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs text-gray-600 mb-1 font-bold uppercase\",children:\"Mes\"}),/*#__PURE__*/_jsx(\"select\",{className:\"w-full border border-gray-300 rounded-lg p-2 text-sm\",value:formData.mes,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{mes:e.target.value})),children:MESES.map(m=>/*#__PURE__*/_jsx(\"option\",{value:m.id,children:m.nombre},m.id))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs text-gray-600 mb-1 font-bold uppercase\",children:\"A\\xF1o\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"w-full border border-gray-300 rounded-lg p-2 text-sm appearance-none\",min:\"2020\",max:\"2030\",value:formData.anio,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{anio:e.target.value}))})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Rol\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"w-full border rounded-lg p-2 \".concat(editingId?'bg-gray-100 text-gray-500 cursor-not-allowed':'border-gray-300'),required:true,value:formData.rol,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{rol:e.target.value,seniority:''})),disabled:!!editingId,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Seleccionar...\"}),uniqueRoles.map(nombre=>/*#__PURE__*/_jsx(\"option\",{value:nombre,children:nombre},nombre))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Experiencia\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"w-full border rounded-lg p-2 \".concat(!formData.rol||editingId?'bg-gray-100 text-gray-500 cursor-not-allowed':'border-gray-300'),value:formData.seniority,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{seniority:e.target.value})),disabled:!formData.rol||!!editingId,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:formData.rol?\"Seleccionar Nivel...\":\"Seleccione Rol primero\"}),filteredExperiencias.map(exp=>/*#__PURE__*/_jsx(\"option\",{value:exp,children:exp},exp))]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Costo (USD)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"w-full border rounded-lg p-2 appearance-none \".concat(usarPorcentaje?'bg-gray-100':'border-gray-300'),required:true,value:formData.costo,readOnly:usarPorcentaje,min:\"0\"// Validación HTML básica\n,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{costo:e.target.value}))})]})]}),editingId&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 p-4 bg-gray-50 rounded-lg border border-gray-200\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",id:\"usarPorcentaje\",checked:usarPorcentaje,onChange:e=>{setUsarPorcentaje(e.target.checked);if(!e.target.checked){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{costo:costoBase}));setPorcentaje('');}},className:\"w-4 h-4 text-blue-600 rounded\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"usarPorcentaje\",className:\"text-sm font-medium text-gray-700\",children:\"Ajustar por porcentaje\"})]}),usarPorcentaje&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative w-1/2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"w-full border border-gray-300 rounded-lg p-2 pr-8 appearance-none\",value:porcentaje,onChange:e=>setPorcentaje(e.target.value)}),/*#__PURE__*/_jsx(\"span\",{className:\"absolute right-3 top-2 text-gray-500\",children:\"%\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500\",children:[\"Base: \",/*#__PURE__*/_jsxs(\"strong\",{children:[\"$\",costoBase]}),\" \\u2192 Nuevo:\",' ',/*#__PURE__*/_jsxs(\"strong\",{children:[\"$\",formData.costo]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end gap-3 mt-6\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setIsModalOpen(false),className:\"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg\",children:\"Cancelar\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\",children:editingId?'Guardar':'Crear'})]})]})]})}),isMassModalOpen&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-2xl w-full max-w-md p-6 animate-fade-in border-t-4 border-purple-500\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 mb-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-2 bg-purple-100 rounded-full\",children:/*#__PURE__*/_jsx(Layers,{className:\"h-6 w-6 text-purple-600\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold text-gray-800\",children:\"Ajuste Masivo de Costos\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600 mb-6\",children:[\"Esta acci\\xF3n actualizar\\xE1 \",/*#__PURE__*/_jsx(\"strong\",{children:\"todos\"}),\" los costos registrados para el mes seleccionado aplicando el porcentaje indicado.\"]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleMassUpdate,className:\"space-y-5\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4 p-4 bg-gray-50 rounded-lg border border-gray-200\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs text-gray-600 mb-1 font-bold uppercase\",children:\"Mes\"}),/*#__PURE__*/_jsx(\"select\",{className:\"w-full border border-gray-300 rounded-lg p-2 text-sm\",value:massFormData.mes,onChange:e=>setMassFormData(_objectSpread(_objectSpread({},massFormData),{},{mes:e.target.value})),children:MESES.map(m=>/*#__PURE__*/_jsx(\"option\",{value:m.id,children:m.nombre},m.id))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs text-gray-600 mb-1 font-bold uppercase\",children:\"A\\xF1o\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"w-full border border-gray-300 rounded-lg p-2 text-sm appearance-none\",min:\"2020\",max:\"2030\",value:massFormData.anio,onChange:e=>setMassFormData(_objectSpread(_objectSpread({},massFormData),{},{anio:e.target.value}))})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Porcentaje de Ajuste\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"w-full border border-gray-300 rounded-lg p-3 pr-10 focus:ring-2 focus:ring-purple-500 focus:border-purple-500 font-mono text-lg appearance-none\",required:true,placeholder:\"Ej: 20 o -5\",value:massFormData.porcentaje,onChange:e=>setMassFormData(_objectSpread(_objectSpread({},massFormData),{},{porcentaje:e.target.value}))}),/*#__PURE__*/_jsx(\"span\",{className:\"absolute right-4 top-3.5 text-gray-500 font-bold\",children:\"%\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:\"* Use valores positivos para aumentos (ej: 20) y negativos para descuentos (ej: -10).\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end gap-3 mt-6 pt-4 border-t border-gray-100\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setIsMassModalOpen(false),className:\"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg font-medium\",children:\"Cancelar\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 font-medium shadow-sm\",children:\"Aplicar Ajuste\"})]})]})]})})]});};export default CostosPage;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","Plus","Edit2","Loader","ArrowLeft","Calendar","Filter","Layers","Trash2","ApiService","AuthService","jsx","_jsx","jsxs","_jsxs","CostosPage","_user$name","navigate","user","getCurrentUser","costos","setCostos","loading","setLoading","allRolesData","setAllRolesData","isModalOpen","setIsModalOpen","isMassModalOpen","setIsMassModalOpen","filtroMes","setFiltroMes","Date","getMonth","filtroAnio","setFiltroAnio","getFullYear","formData","setFormData","rol","seniority","costo","moneda","mes","anio","massFormData","setMassFormData","porcentaje","usarPorcentaje","setUsarPorcentaje","setPorcentaje","costoBase","setCostoBase","editingId","setEditingId","MESES","id","nombre","loadData","dataCostos","dataRolesCompletos","Promise","all","obtenerCostosVigentes","obtenerTodosLosRoles","datosProcesados","map","item","rolEncontrado","find","r","rolId","rolDisplay","seniorityDisplay","experiencia","_objectSpread","error","console","costosFiltrados","filter","c","fecha","partes","split","anioCosto","parseInt","mesCosto","calcularValorConPorcentaje","valorBase","porc","isNaN","base","parseFloat","p","resultado","toFixed","nuevoValor","prev","uniqueRoles","Set","sort","filteredExperiencias","handleEdit","mesEdit","anioEdit","length","handleDelete","window","confirm","eliminarCosto","alert","handleSave","e","preventDefault","existeDuplicado","some","anioStr","mesStr","concat","datosCosto","toString","actualizarCosto","crearCosto","e2","handleNuevoCosto","handleMassUpdate","costosAfectados","algunNegativo","promesas","formatVigencia","fechaString","mesIndex","nombreMes","className","children","onClick","title","name","charAt","value","onChange","target","m","type","min","max","size","colSpan","index","onSubmit","required","disabled","exp","readOnly","checked","htmlFor","placeholder"],"sources":["/home/agusdubo/Desktop/IS1/tribu-A-frontend-2025-2C/src/pages/CostosPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom'; \nimport { Plus, Edit2, Loader, ArrowLeft, Calendar, Filter, Layers, Trash2 } from 'lucide-react'; \nimport { ApiService } from '../services/api';\nimport AuthService from '../services/AuthService';\n\nconst CostosPage = () => {\n    const navigate = useNavigate();\n    const user = AuthService.getCurrentUser();\n\n    const [costos, setCostos] = useState([]);\n    const [loading, setLoading] = useState(true);\n\n    // Catálogo completo de roles (ID, Nombre, Experiencia)\n    const [allRolesData, setAllRolesData] = useState([]);\n\n    // Modales\n    const [isModalOpen, setIsModalOpen] = useState(false);\n    const [isMassModalOpen, setIsMassModalOpen] = useState(false);\n\n    // Filtros\n    const [filtroMes, setFiltroMes] = useState(new Date().getMonth() + 1);\n    const [filtroAnio, setFiltroAnio] = useState(new Date().getFullYear());\n\n    // Form individual\n    const [formData, setFormData] = useState({\n        rol: '',\n        seniority: '',\n        costo: '',\n        moneda: 'USD',\n        mes: new Date().getMonth() + 1,\n        anio: new Date().getFullYear()\n    });\n\n    // Form masivo\n    const [massFormData, setMassFormData] = useState({\n        mes: new Date().getMonth() + 1,\n        anio: new Date().getFullYear(),\n        porcentaje: ''\n    });\n\n    // Edición individual\n    const [usarPorcentaje, setUsarPorcentaje] = useState(false);\n    const [porcentaje, setPorcentaje] = useState('');\n    const [costoBase, setCostoBase] = useState(0);\n    const [editingId, setEditingId] = useState(null);\n\n    const MESES = [\n        { id: 1, nombre: 'Enero' }, { id: 2, nombre: 'Febrero' }, { id: 3, nombre: 'Marzo' },\n        { id: 4, nombre: 'Abril' }, { id: 5, nombre: 'Mayo' }, { id: 6, nombre: 'Junio' },\n        { id: 7, nombre: 'Julio' }, { id: 8, nombre: 'Agosto' }, { id: 9, nombre: 'Septiembre' },\n        { id: 10, nombre: 'Octubre' }, { id: 11, nombre: 'Noviembre' }, { id: 12, nombre: 'Diciembre' }\n    ];\n\n    // --- Lógica de carga de datos ---\n    const loadData = async () => {\n        setLoading(true);\n        try {\n            // 1. Traemos Costos y Roles (objetos completos) en paralelo\n            const [dataCostos, dataRolesCompletos] = await Promise.all([\n                ApiService.obtenerCostosVigentes(),\n                ApiService.obtenerTodosLosRoles() \n            ]);\n\n            // Guardamos el catálogo completo para usarlo en el formulario\n            setAllRolesData(dataRolesCompletos || []);\n\n            // 2. Cruzamos la información para la tabla\n            const datosProcesados = dataCostos.map(item => {\n                const rolEncontrado = dataRolesCompletos.find(r => r.id === item.rolId);\n                \n                const rolDisplay = rolEncontrado ? rolEncontrado.nombre : 'Rol Desconocido';\n                const seniorityDisplay = rolEncontrado ? rolEncontrado.experiencia : 'N/A';\n\n                return { ...item, rolDisplay, seniorityDisplay };\n            });\n            \n            setCostos(datosProcesados);\n        } catch (error) {\n            console.error(\"Error cargando costos\", error);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    useEffect(() => {\n        loadData();\n    }, []);\n\n    const costosFiltrados = costos.filter(c => {\n        if (!c.fecha) return false;\n        const partes = c.fecha.split('-'); // \"YYYY-MM-DD\"\n        const anioCosto = parseInt(partes[0]);\n        const mesCosto = parseInt(partes[1]);\n        return anioCosto === parseInt(filtroAnio) && mesCosto === parseInt(filtroMes);\n    });\n\n    const calcularValorConPorcentaje = (valorBase, porc) => {\n        if (!valorBase || isNaN(valorBase) || !porc || isNaN(porc)) return valorBase;\n        const base = parseFloat(valorBase);\n        const p = parseFloat(porc);\n        const resultado = base + (base * (p / 100));\n        \n        // Retornamos string fijo, pero validamos negativo después\n        return resultado.toFixed(2);\n    };\n\n    useEffect(() => {\n        if (usarPorcentaje && editingId) {\n            const nuevoValor = calcularValorConPorcentaje(costoBase, porcentaje);\n            setFormData(prev => ({ ...prev, costo: nuevoValor }));\n        }\n    }, [porcentaje, usarPorcentaje, costoBase, editingId]);\n\n    // Obtener lista de Nombres de Roles Únicos para el select\n    const uniqueRoles = [...new Set(allRolesData.map(r => r.nombre))].sort();\n\n    // Obtener lista de Experiencias filtradas por el Rol seleccionado\n    const filteredExperiencias = allRolesData\n        .filter(r => r.nombre === formData.rol)\n        .map(r => r.experiencia)\n        .sort();\n\n    const handleEdit = (item) => {\n        setEditingId(item.id);\n\n        let mesEdit = new Date().getMonth() + 1;\n        let anioEdit = new Date().getFullYear();\n\n        if (item.fecha) {\n            const partes = item.fecha.split('-');\n            if (partes.length >= 2) {\n                anioEdit = parseInt(partes[0]);\n                mesEdit = parseInt(partes[1]);\n            }\n        }\n\n        setCostoBase(item.costo);\n        setUsarPorcentaje(false);\n        setPorcentaje('');\n\n        setFormData({\n            rol: item.rolDisplay,\n            seniority: item.seniorityDisplay !== 'N/A' ? item.seniorityDisplay : '',\n            costo: item.costo,\n            moneda: 'USD',\n            mes: mesEdit,\n            anio: anioEdit\n        });\n        setIsModalOpen(true);\n    };\n\n    const handleDelete = async (id) => {\n        if (window.confirm(\"¿Estás seguro de que deseas eliminar este costo? Esta acción no se puede deshacer.\")) {\n            try {\n                await ApiService.eliminarCosto(id);\n                alert(\"Costo eliminado correctamente\");\n                loadData();\n            } catch (error) {\n                console.error(error);\n                alert(\"Error al eliminar el costo\");\n            }\n        }\n    };\n\n    const handleSave = async (e) => {\n        e.preventDefault();\n        \n        // --- VALIDACIÓN DE COSTO NEGATIVO ---\n        if (parseFloat(formData.costo) < 0) {\n            alert(\"El costo no puede ser negativo. Por favor ingrese un valor válido.\");\n            return;\n        }\n        // ------------------------------------\n\n        // --- VALIDACIÓN DE DUPLICADOS ---\n        const existeDuplicado = costos.some(c => {\n            // Si estamos editando, no comparamos contra el mismo registro\n            if (editingId && c.id === editingId) return false;\n\n            // Obtenemos mes y año del costo existente\n            if (!c.fecha) return false;\n            const [anioStr, mesStr] = c.fecha.split('-');\n            const anioCosto = parseInt(anioStr);\n            const mesCosto = parseInt(mesStr);\n\n            // Comparamos: Rol (nombre), Seniority, Mes y Año\n            return (\n                c.rolDisplay === formData.rol &&\n                c.seniorityDisplay === formData.seniority &&\n                anioCosto === parseInt(formData.anio) &&\n                mesCosto === parseInt(formData.mes)\n            );\n        });\n\n        if (existeDuplicado) {\n            alert(`Ya existe un costo registrado para el rol \"${formData.rol}\" (${formData.seniority}) en este período.`);\n            return; // Detenemos la ejecución aquí\n        }\n        // ---------------------------------\n\n        const datosCosto = { \n            rolId: formData.rol, \n            nombre: formData.rol, \n            experiencia: formData.seniority,\n            costo: formData.costo.toString(),\n            mes: parseInt(formData.mes),\n            anio: parseInt(formData.anio)\n        };\n\n        try {\n            if (editingId) {\n                await ApiService.actualizarCosto(editingId, datosCosto);\n                alert(\"Costo mensual actualizado correctamente\");\n            } else {\n                await ApiService.crearCosto(datosCosto);\n                alert(\"Nuevo costo mensual registrado\");\n            }\n            \n            setIsModalOpen(false);\n            setEditingId(null);\n            setUsarPorcentaje(false);\n            setPorcentaje('');\n            \n            setFiltroMes(parseInt(formData.mes));\n            setFiltroAnio(parseInt(formData.anio));\n\n            loadData();\n        } catch (e2) { \n            console.error(e2);\n            alert(\"Error al guardar la operación. Verifique los datos\"); \n        }\n    };\n\n    const handleNuevoCosto = () => {\n        setFormData({\n            rol: '',\n            seniority: '',\n            costo: '',\n            mes: filtroMes,\n            anio: filtroAnio\n        });\n        setEditingId(null);\n        setUsarPorcentaje(false);\n        setIsModalOpen(true);\n    };\n\n    const handleMassUpdate = async (e) => {\n        e.preventDefault();\n\n        const costosAfectados = costos.filter(c => {\n            if (!c.fecha) return false;\n            const partes = c.fecha.split('-');\n            const anioCosto = parseInt(partes[0]);\n            const mesCosto = parseInt(partes[1]);\n            return anioCosto === parseInt(massFormData.anio) && mesCosto === parseInt(massFormData.mes);\n        });\n\n        if (costosAfectados.length === 0) {\n            alert(\"No hay costos registrados para el mes seleccionado\");\n            return;\n        }\n\n        // --- VALIDACIÓN PREVIA: ¿Algún costo queda negativo? ---\n        const algunNegativo = costosAfectados.some(c => {\n            const nuevoValor = calcularValorConPorcentaje(c.costo, massFormData.porcentaje);\n            return parseFloat(nuevoValor) < 0;\n        });\n\n        if (algunNegativo) {\n            alert(\"La operación no se puede realizar porque resultaría en costos negativos para uno o más roles.\");\n            return;\n        }\n        // -------------------------------------------------------\n\n        if (!window.confirm(`Se actualizarán ${costosAfectados.length} costos con un ${massFormData.porcentaje}%. ¿Continuar?`)) {\n            return;\n        }\n\n        setLoading(true);\n        try {\n            const promesas = costosAfectados.map(costo => {\n                const nuevoValor = calcularValorConPorcentaje(costo.costo, massFormData.porcentaje);\n\n                const datosCosto = {\n                    costo: nuevoValor.toString(),\n                    mes: parseInt(massFormData.mes),\n                    anio: parseInt(massFormData.anio)\n                };\n\n                return ApiService.actualizarCosto(costo.id, datosCosto);\n            });\n\n            await Promise.all(promesas);\n\n            alert(\"Actualización masiva completada con éxito\");\n            setIsMassModalOpen(false);\n            setFiltroMes(parseInt(massFormData.mes));\n            setFiltroAnio(parseInt(massFormData.anio));\n            loadData();\n\n        } catch (error) {\n            console.error(\"Error en actualización masiva:\", error);\n            alert(\"Ocurrió un error durante la actualización masiva. Algunos costos pueden no haberse actualizado\");\n            loadData();\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const formatVigencia = (fechaString) => {\n        if (!fechaString) return '-';\n        const partes = fechaString.split('-');\n        if (partes.length < 2) return fechaString;\n        const anio = partes[0];\n        const mesIndex = parseInt(partes[1]) - 1;\n        const nombreMes = MESES[mesIndex] ? MESES[mesIndex].nombre : partes[1];\n        return `${nombreMes} ${anio}`;\n    };\n\n    return (\n        <div className=\"min-h-screen bg-gray-50 font-sans text-gray-900\">\n            {/* HEADER */}\n            <header className=\"bg-white border-b border-gray-200 shadow-sm sticky top-0 z-10\">\n                <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n                    <div className=\"flex justify-between items-center h-16\">\n                        <div className=\"flex items-center gap-4\">\n                            <button \n                                onClick={() => navigate('/finanzas/dashboard')}\n                                className=\"p-2 rounded-full text-gray-500 hover:bg-gray-100 hover:text-gray-800 transition-colors\"\n                                title=\"Volver al Menú\"\n                            >\n                                <ArrowLeft className=\"h-6 w-6\" />\n                            </button>\n                            <div className=\"flex items-center space-x-2 border-l border-gray-200 pl-4 h-8\">\n                                <span className=\"text-xl font-bold tracking-tight text-gray-900\">\n                                    Gestión de Costos\n                                </span>\n                            </div>\n                        </div>\n                        <div className=\"flex items-center space-x-4\">\n                            <span className=\"hidden sm:block font-medium text-gray-500\">\n                                {user?.name || 'Manager'}\n                            </span>\n                            <div className=\"h-10 w-10 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold\">\n                                {user?.name?.charAt(0) || 'M'}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </header>\n\n            {/* CONTENIDO */}\n            <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n                {/* BARRA DE FILTROS Y ACCIONES */}\n                <div className=\"bg-white p-4 rounded-xl shadow-sm border border-gray-200 mb-6 flex flex-col md:flex-row justify-between items-center gap-4\">\n                    <div className=\"flex items-center gap-4 w-full md:w-auto\">\n                        <div className=\"flex items-center gap-2 text-gray-700 font-medium\">\n                            <Filter className=\"h-5 w-5 text-gray-400\" />\n                            <span>Periodo:</span>\n                        </div>\n                        <div className=\"flex gap-2\">\n                            <select\n                                className=\"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5\"\n                                value={filtroMes}\n                                onChange={e => setFiltroMes(parseInt(e.target.value))}\n                            >\n                                {MESES.map(m => (\n                                    <option key={m.id} value={m.id}>{m.nombre}</option>\n                                ))}\n                            </select>\n                            \n                            <input\n                                type=\"number\"\n                                className=\"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5 w-24 appearance-none\"\n                                value={filtroAnio}\n                                onChange={e => setFiltroAnio(parseInt(e.target.value))}\n                                min=\"2020\"\n                                max=\"2030\"\n                            />\n                        </div>\n                    </div>\n\n                    <div className=\"flex gap-2 w-full md:w-auto\">\n                        <button\n                            onClick={() => {\n                                setMassFormData({\n                                    mes: filtroMes,\n                                    anio: filtroAnio,\n                                    porcentaje: ''\n                                });\n                                setIsMassModalOpen(true);\n                            }}\n                            className=\"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 shadow-sm transition justify-center text-sm\"\n                        >\n                            <Layers size={18} /> Ajuste Masivo\n                        </button>\n\n                        <button\n                            onClick={handleNuevoCosto}\n                            className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 shadow-sm transition justify-center text-sm\"\n                        >\n                            <Plus size={18} /> Nuevo Costo\n                        </button>\n                    </div>\n                </div>\n\n                {/* TABLA */}\n                <div className=\"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden\">\n                    <table className=\"w-full text-left\">\n                        <thead className=\"bg-gray-50 text-gray-600 text-sm uppercase\">\n                            <tr>\n                                <th className=\"px-6 py-4 font-semibold\">Nombre del Rol</th>\n                                <th className=\"px-6 py-4 font-semibold\">Experiencia</th>\n                                <th className=\"px-6 py-4 font-semibold\">Costo por Hora</th>\n                                <th className=\"px-6 py-4 font-semibold min-w-[150px]\">Mes de Vigencia</th>\n                                <th className=\"px-6 py-4 font-semibold text-right min-w-[120px]\">Acciones</th>\n                            </tr>\n                        </thead>\n                        <tbody className=\"divide-y divide-gray-100\">\n                            {loading ? (\n                                <tr>\n                                    <td colSpan=\"5\" className=\"p-8 text-center\">\n                                        <Loader className=\"animate-spin mx-auto text-blue-500\" />\n                                    </td>\n                                </tr>\n                            ) : (\n                                costosFiltrados.length > 0 ? (\n                                    costosFiltrados.map((c, index) => (\n                                        <tr key={index} className=\"hover:bg-gray-50 transition\">\n                                            <td className=\"px-6 py-4 font-medium text-gray-800\">{c.rolDisplay}</td>\n                                            <td className=\"px-6 py-4\">\n                                                <span\n                                                    className={`px-2 py-1 rounded-full text-xs font-medium border ${\n                                                        c.seniorityDisplay === 'Senior'\n                                                            ? 'bg-purple-50 text-purple-700 border-purple-100'\n                                                            : c.seniorityDisplay === 'Semi-Senior'\n                                                            ? 'bg-blue-50 text-blue-700 border-blue-100'\n                                                            : 'bg-gray-50 text-gray-700 border-gray-200'\n                                                    }`}\n                                                >\n                                                    {c.seniorityDisplay}\n                                                </span>\n                                            </td>\n                                            <td className=\"px-6 py-4 font-mono text-gray-700 font-bold\">\n                                                USD {c.costo}\n                                            </td>\n                                            <td className=\"px-6 py-4 text-sm text-gray-500 whitespace-nowrap\">\n                                                <div className=\"flex items-center gap-2\">\n                                                    <Calendar size={14} />\n                                                    {formatVigencia(c.fecha)}\n                                                </div>\n                                            </td>\n                                            <td className=\"px-6 py-4 text-right whitespace-nowrap\">\n                                                <div className=\"flex justify-end gap-2\">\n                                                    <button\n                                                        onClick={() => handleEdit(c)}\n                                                        className=\"text-blue-600 hover:text-blue-800 font-medium text-sm flex items-center gap-1\"\n                                                        title=\"Editar\"\n                                                    >\n                                                        <Edit2 size={18} />\n                                                    </button>\n                                                    <button\n                                                        onClick={() => handleDelete(c.id)}\n                                                        className=\"text-red-600 hover:text-red-800 font-medium text-sm flex items-center gap-1 ml-2\"\n                                                        title=\"Eliminar\"\n                                                    >\n                                                        <Trash2 size={18} />\n                                                    </button>\n                                                </div>\n                                            </td>\n                                        </tr>\n                                    ))\n                                ) : (\n                                    <tr>\n                                        <td colSpan=\"5\" className=\"px-6 py-12 text-center text-gray-500\">\n                                            No hay costos cargados para <b>{MESES[filtroMes - 1].nombre} {filtroAnio}</b>.\n                                        </td>\n                                    </tr>\n                                )\n                            )}\n                        </tbody>\n                    </table>\n                </div>\n            </main>\n\n            {/* MODAL INDIVIDUAL */}\n            {isModalOpen && (\n                <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n                    <div className=\"bg-white rounded-xl shadow-2xl w-full max-w-md p-6 animate-fade-in\">\n                        <h3 className=\"text-lg font-bold mb-4 text-gray-800\">\n                            {editingId ? 'Editar Costo Mensual' : 'Registrar Costo Mensual'}\n                        </h3>\n                        <form onSubmit={handleSave} className=\"space-y-4\">\n                            <div className=\"grid grid-cols-2 gap-4 p-4 bg-blue-50 rounded-lg border border-blue-100\">\n                                <div>\n                                    <label className=\"block text-xs text-gray-600 mb-1 font-bold uppercase\">\n                                        Mes\n                                    </label>\n                                    <select\n                                        className=\"w-full border border-gray-300 rounded-lg p-2 text-sm\"\n                                        value={formData.mes}\n                                        onChange={e => setFormData({ ...formData, mes: e.target.value })}\n                                    >\n                                        {MESES.map(m => (\n                                            <option key={m.id} value={m.id}>{m.nombre}</option>\n                                        ))}\n                                    </select>\n                                </div>\n                                <div>\n                                    <label className=\"block text-xs text-gray-600 mb-1 font-bold uppercase\">\n                                        Año\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        className=\"w-full border border-gray-300 rounded-lg p-2 text-sm appearance-none\" \n                                        min=\"2020\"\n                                        max=\"2030\"\n                                        value={formData.anio}\n                                        onChange={e => setFormData({ ...formData, anio: e.target.value })}\n                                    />\n                                </div>\n                            </div>\n\n                            {/* ROL */}\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Rol</label>\n                                <select\n                                    className={`w-full border rounded-lg p-2 ${\n                                        editingId\n                                            ? 'bg-gray-100 text-gray-500 cursor-not-allowed'\n                                            : 'border-gray-300'\n                                    }`}\n                                    required\n                                    value={formData.rol}\n                                    onChange={e =>\n                                        setFormData({\n                                            ...formData,\n                                            rol: e.target.value,\n                                            seniority: ''\n                                        })\n                                    }\n                                    disabled={!!editingId}\n                                >\n                                    <option value=\"\">Seleccionar...</option>\n                                    {uniqueRoles.map(nombre => (\n                                        <option key={nombre} value={nombre}>\n                                            {nombre}\n                                        </option>\n                                    ))}\n                                </select>\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                {/* SENIORITY */}\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Experiencia</label>\n                                    <select\n                                        className={`w-full border rounded-lg p-2 ${\n                                            (!formData.rol || editingId)\n                                                ? 'bg-gray-100 text-gray-500 cursor-not-allowed'\n                                                : 'border-gray-300'\n                                        }`}\n                                        value={formData.seniority}\n                                        onChange={e => setFormData({ ...formData, seniority: e.target.value })}\n                                        disabled={!formData.rol || !!editingId}\n                                    >\n                                        <option value=\"\">\n                                            {formData.rol ? \"Seleccionar Nivel...\" : \"Seleccione Rol primero\"}\n                                        </option>\n                                        {filteredExperiencias.map(exp => (\n                                            <option key={exp} value={exp}>\n                                                {exp}\n                                            </option>\n                                        ))}\n                                    </select>\n                                </div>\n\n                                {/* COSTO */}\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Costo (USD)</label>\n                                    <input\n                                        type=\"number\"\n                                        className={`w-full border rounded-lg p-2 appearance-none ${\n                                            usarPorcentaje ? 'bg-gray-100' : 'border-gray-300'\n                                        }`}\n                                        required\n                                        value={formData.costo}\n                                        readOnly={usarPorcentaje}\n                                        min=\"0\" // Validación HTML básica\n                                        onChange={e => setFormData({ ...formData, costo: e.target.value })}\n                                    />\n                                </div>\n                            </div>\n\n                            {/* AJUSTE POR PORCENTAJE (EDICIÓN) */}\n                            {editingId && (\n                                <div className=\"mt-4 p-4 bg-gray-50 rounded-lg border border-gray-200\">\n                                    <div className=\"flex items-center gap-2 mb-2\">\n                                        <input\n                                            type=\"checkbox\"\n                                            id=\"usarPorcentaje\"\n                                            checked={usarPorcentaje}\n                                            onChange={e => {\n                                                setUsarPorcentaje(e.target.checked);\n                                                if (!e.target.checked) {\n                                                    setFormData(prev => ({ ...prev, costo: costoBase }));\n                                                    setPorcentaje('');\n                                                }\n                                            }}\n                                            className=\"w-4 h-4 text-blue-600 rounded\"\n                                        />\n                                        <label htmlFor=\"usarPorcentaje\" className=\"text-sm font-medium text-gray-700\">\n                                            Ajustar por porcentaje\n                                        </label>\n                                    </div>\n                                    {usarPorcentaje && (\n                                        <div className=\"flex items-center gap-3\">\n                                            <div className=\"relative w-1/2\">\n                                                <input\n                                                    type=\"number\"\n                                                    className=\"w-full border border-gray-300 rounded-lg p-2 pr-8 appearance-none\"\n                                                    value={porcentaje}\n                                                    onChange={e => setPorcentaje(e.target.value)}\n                                                />\n                                                <span className=\"absolute right-3 top-2 text-gray-500\">%</span>\n                                            </div>\n                                            <div className=\"text-xs text-gray-500\">\n                                                Base: <strong>${costoBase}</strong> → Nuevo:{' '}\n                                                <strong>${formData.costo}</strong>\n                                            </div>\n                                        </div>\n                                    )}\n                                </div>\n                            )}\n\n                            <div className=\"flex justify-end gap-3 mt-6\">\n                                <button\n                                    type=\"button\"\n                                    onClick={() => setIsModalOpen(false)}\n                                    className=\"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg\"\n                                >\n                                    Cancelar\n                                </button>\n                                <button\n                                    type=\"submit\"\n                                    className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\"\n                                >\n                                    {editingId ? 'Guardar' : 'Crear'}\n                                </button>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            )}\n\n            {/* MODAL MASIVO */}\n            {isMassModalOpen && (\n                <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n                    <div className=\"bg-white rounded-xl shadow-2xl w-full max-w-md p-6 animate-fade-in border-t-4 border-purple-500\">\n                        <div className=\"flex items-center gap-3 mb-4\">\n                            <div className=\"p-2 bg-purple-100 rounded-full\">\n                                <Layers className=\"h-6 w-6 text-purple-600\" />\n                            </div>\n                            <h3 className=\"text-lg font-bold text-gray-800\">Ajuste Masivo de Costos</h3>\n                        </div>\n\n                        <p className=\"text-sm text-gray-600 mb-6\">\n                            Esta acción actualizará <strong>todos</strong> los costos registrados para el mes seleccionado aplicando el porcentaje indicado.\n                        </p>\n\n                        <form onSubmit={handleMassUpdate} className=\"space-y-5\">\n                            <div className=\"grid grid-cols-2 gap-4 p-4 bg-gray-50 rounded-lg border border-gray-200\">\n                                <div>\n                                    <label className=\"block text-xs text-gray-600 mb-1 font-bold uppercase\">\n                                        Mes\n                                    </label>\n                                    <select\n                                        className=\"w-full border border-gray-300 rounded-lg p-2 text-sm\"\n                                        value={massFormData.mes}\n                                        onChange={e => setMassFormData({ ...massFormData, mes: e.target.value })}\n                                    >\n                                        {MESES.map(m => (\n                                            <option key={m.id} value={m.id}>{m.nombre}</option>\n                                        ))}\n                                    </select>\n                                </div>\n                                <div>\n                                    <label className=\"block text-xs text-gray-600 mb-1 font-bold uppercase\">\n                                        Año\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        className=\"w-full border border-gray-300 rounded-lg p-2 text-sm appearance-none\"\n                                        min=\"2020\"\n                                        max=\"2030\"\n                                        value={massFormData.anio}\n                                        onChange={e => setMassFormData({ ...massFormData, anio: e.target.value })}\n                                    />\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                                    Porcentaje de Ajuste\n                                </label>\n                                <div className=\"relative\">\n                                    <input\n                                        type=\"number\"\n                                        className=\"w-full border border-gray-300 rounded-lg p-3 pr-10 focus:ring-2 focus:ring-purple-500 focus:border-purple-500 font-mono text-lg appearance-none\"\n                                        required\n                                        placeholder=\"Ej: 20 o -5\"\n                                        value={massFormData.porcentaje}\n                                        onChange={e => setMassFormData({ ...massFormData, porcentaje: e.target.value })}\n                                    />\n                                    <span className=\"absolute right-4 top-3.5 text-gray-500 font-bold\">%</span>\n                                </div>\n                                <p className=\"text-xs text-gray-500 mt-1\">\n                                    * Use valores positivos para aumentos (ej: 20) y negativos para descuentos (ej: -10).\n                                </p>\n                            </div>\n\n                            <div className=\"flex justify-end gap-3 mt-6 pt-4 border-t border-gray-100\">\n                                <button\n                                    type=\"button\"\n                                    onClick={() => setIsMassModalOpen(false)}\n                                    className=\"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg font-medium\"\n                                >\n                                    Cancelar\n                                </button>\n                                <button\n                                    type=\"submit\"\n                                    className=\"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 font-medium shadow-sm\"\n                                >\n                                    Aplicar Ajuste\n                                </button>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            )}\n        </div>\n    );\n};\n\nexport default CostosPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}