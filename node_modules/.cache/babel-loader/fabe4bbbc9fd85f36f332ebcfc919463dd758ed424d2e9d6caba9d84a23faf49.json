{"ast":null,"code":"import React,{useState,useEffect,useMemo}from'react';import{useNavigate}from'react-router-dom';import{Folder}from'lucide-react';import Header from'../components/Header';import LoadingState from'../components/LoadingState';import APIClient from'../services/APIClient';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProjectCostSelection=()=>{const navigate=useNavigate();const[projects,setProjects]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const today=new Date();// ✅ CAMBIO: Ahora son AÑOS en lugar de MESES\nconst YEARS=useMemo(()=>{const currentYear=today.getFullYear();const years=[];for(let i=0;i<5;i++){const year=currentYear-i;years.push({value:year,text:year.toString()});}return years;},[today]);useEffect(()=>{const loadProjects=async()=>{setLoading(true);setError(null);try{const data=await APIClient.getAllProjects();setProjects(data);}catch(err){setError(\"Error al cargar proyectos: \".concat(err.message));}finally{setLoading(false);}};loadProjects();},[]);const handleReportSubmit=(e,projectId,projectName)=>{e.preventDefault();const year=e.target.year.value;navigate(\"/manager/reportes/reporte-costos?id=\".concat(projectId,\"&name=\").concat(encodeURIComponent(projectName),\"&year=\").concat(year));};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-100 font-sans text-gray-900\",children:[/*#__PURE__*/_jsx(Header,{title:\"Reporte de Costos por Proyecto\",subtitle:\"Seleccione un proyecto y a\\xF1o\",showBack:true,backPath:\"/manager/reportes\"}),/*#__PURE__*/_jsxs(\"main\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\",children:[loading&&/*#__PURE__*/_jsx(LoadingState,{message:\"Cargando lista de proyectos...\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-100 border border-red-400 text-red-700 p-4 rounded mb-6\",children:error}),!loading&&projects.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-xl shadow-sm border border-gray-200 overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full divide-y divide-gray-200\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider\",children:\"C\\xF3digo\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider\",children:\"Nombre\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider min-w-[300px]\",children:\"Seleccionar A\\xF1o y Generar\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"bg-white divide-y divide-gray-200\",children:projects.map(proyecto=>/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-gray-50 transition-colors\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 font-medium text-gray-900\",children:proyecto.id}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 text-sm text-gray-600\",children:proyecto.nombre}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 text-sm text-gray-600\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"flex gap-2 items-center\",onSubmit:e=>handleReportSubmit(e,proyecto.id,proyecto.nombre),children:[/*#__PURE__*/_jsx(\"select\",{name:\"year\",required:true,className:\"bg-gray-50 border border-gray-300 rounded-md p-2 text-sm\",children:YEARS.map(y=>/*#__PURE__*/_jsx(\"option\",{value:y.value,children:y.text},y.value))}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors\",children:\"Ver Reporte\"})]})})]},proyecto.id))})]})}),!loading&&projects.length===0&&!error&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center p-10 bg-white rounded-xl shadow-sm border border-gray-200\",children:[/*#__PURE__*/_jsx(Folder,{className:\"h-10 w-10 text-gray-400 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg font-medium\",children:\"No hay proyectos disponibles.\"})]})]})]});};export default ProjectCostSelection;","map":{"version":3,"names":["React","useState","useEffect","useMemo","useNavigate","Folder","Header","LoadingState","APIClient","jsx","_jsx","jsxs","_jsxs","ProjectCostSelection","navigate","projects","setProjects","loading","setLoading","error","setError","today","Date","YEARS","currentYear","getFullYear","years","i","year","push","value","text","toString","loadProjects","data","getAllProjects","err","concat","message","handleReportSubmit","e","projectId","projectName","preventDefault","target","encodeURIComponent","className","children","title","subtitle","showBack","backPath","length","map","proyecto","id","nombre","onSubmit","name","required","y","type"],"sources":["/home/agusdubo/Desktop/IS1/tribu-A-frontend-2025-2C/src/pages/ProjectCostSelection.js"],"sourcesContent":["import React, { useState, useEffect, useMemo } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Folder } from 'lucide-react';\nimport Header from '../components/Header';\nimport LoadingState from '../components/LoadingState';\nimport APIClient from '../services/APIClient';\n\nconst ProjectCostSelection = () => {\n    const navigate = useNavigate();\n    const [projects, setProjects] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n    const today = new Date();\n\n    // ✅ CAMBIO: Ahora son AÑOS en lugar de MESES\n    const YEARS = useMemo(() => {\n        const currentYear = today.getFullYear();\n        const years = [];\n        for (let i = 0; i < 5; i++) {\n            const year = currentYear - i;\n            years.push({ value: year, text: year.toString() });\n        }\n        return years;\n    }, [today]);\n\n    useEffect(() => {\n        const loadProjects = async () => {\n            setLoading(true);\n            setError(null);\n            try {\n                const data = await APIClient.getAllProjects();\n                setProjects(data);\n            } catch (err) {\n                setError(`Error al cargar proyectos: ${err.message}`);\n            } finally {\n                setLoading(false);\n            }\n        };\n        loadProjects();\n    }, []);\n\n    const handleReportSubmit = (e, projectId, projectName) => {\n        e.preventDefault();\n        const year = e.target.year.value;\n        navigate(`/manager/reportes/reporte-costos?id=${projectId}&name=${encodeURIComponent(projectName)}&year=${year}`);\n    };\n\n    return (\n        <div className=\"min-h-screen bg-gray-100 font-sans text-gray-900\">\n            <Header\n                title=\"Reporte de Costos por Proyecto\"\n                subtitle=\"Seleccione un proyecto y año\"\n                showBack={true}\n                backPath=\"/manager/reportes\"\n            />\n\n            <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n                {loading && <LoadingState message=\"Cargando lista de proyectos...\" />}\n                {error && <div className=\"bg-red-100 border border-red-400 text-red-700 p-4 rounded mb-6\">{error}</div>}\n\n                {!loading && projects.length > 0 && (\n                    <div className=\"bg-white rounded-xl shadow-sm border border-gray-200 overflow-x-auto\">\n                        <table className=\"min-w-full divide-y divide-gray-200\">\n                            <thead className=\"bg-gray-50\">\n                            <tr>\n                                <th className=\"px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider\">Código</th>\n                                <th className=\"px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider\">Nombre</th>\n                                <th className=\"px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider min-w-[300px]\">Seleccionar Año y Generar</th>\n                            </tr>\n                            </thead>\n                            <tbody className=\"bg-white divide-y divide-gray-200\">\n                            {projects.map(proyecto => (\n                                <tr key={proyecto.id} className=\"hover:bg-gray-50 transition-colors\">\n                                    <td className=\"px-6 py-4 font-medium text-gray-900\">{proyecto.id}</td>\n                                    <td className=\"px-6 py-4 text-sm text-gray-600\">{proyecto.nombre}</td>\n                                    <td className=\"px-6 py-4 text-sm text-gray-600\">\n                                        <form className=\"flex gap-2 items-center\" onSubmit={(e) => handleReportSubmit(e, proyecto.id, proyecto.nombre)}>\n                                            <select name=\"year\" required className=\"bg-gray-50 border border-gray-300 rounded-md p-2 text-sm\">\n                                                {YEARS.map(y => (\n                                                    <option key={y.value} value={y.value}>{y.text}</option>\n                                                ))}\n                                            </select>\n                                            <button type=\"submit\" className=\"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors\">\n                                                Ver Reporte\n                                            </button>\n                                        </form>\n                                    </td>\n                                </tr>\n                            ))}\n                            </tbody>\n                        </table>\n                    </div>\n                )}\n                {!loading && projects.length === 0 && !error && (\n                    <div className=\"text-center p-10 bg-white rounded-xl shadow-sm border border-gray-200\">\n                        <Folder className=\"h-10 w-10 text-gray-400 mx-auto mb-4\" />\n                        <p className=\"text-lg font-medium\">No hay proyectos disponibles.</p>\n                    </div>\n                )}\n            </main>\n        </div>\n    );\n};\n\nexport default ProjectCostSelection;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}